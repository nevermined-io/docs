"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8617],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=n.createContext({}),d=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},p=function(e){var t=d(e.components);return n.createElement(c.Provider,{value:t},e.children)},l={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=d(r),m=o,h=u["".concat(c,".").concat(m)]||u[m]||l[m]||i;return r?n.createElement(h,a(a({ref:t},p),{},{components:r})):n.createElement(h,a({ref:t},p))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,a=new Array(i);a[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var d=2;d<i;d++)a[d]=r[d];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},29870:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>s,toc:()=>d});var n=r(87462),o=(r(67294),r(3905));const i={sidebar_position:13,description:"Payment Plans credits redemption"},a="Credits Redemption",s={unversionedId:"protocol/credits-redemption",id:"protocol/credits-redemption",title:"Credits Redemption",description:"Payment Plans credits redemption",source:"@site/docs/protocol/credits-redemption.mdx",sourceDirName:"protocol",slug:"/protocol/credits-redemption",permalink:"/docs/protocol/credits-redemption",draft:!1,editUrl:"https://github.com/nevermined-io/docs/tree/main/docs/protocol/credits-redemption.mdx",tags:[],version:"current",sidebarPosition:13,frontMatter:{sidebar_position:13,description:"Payment Plans credits redemption"},sidebar:"tutorialSidebar",previous:{title:"Agents Query Protocol",permalink:"/docs/protocol/query-protocol"},next:{title:"Getting Started with the Tutorials",permalink:"/docs/tutorials/"}},c={},d=[],p={toc:d};function l(e){let{components:t,...i}=e;return(0,o.kt)("wrapper",(0,n.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"credits-redemption"},"Credits Redemption"),(0,o.kt)("p",null,"Nevermined authorizes access to AI agents and, depending on each redemption criteria, charges the users a specific amount of credits for their successful access."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Users getting access to AI Agents associated with a time limited plan don\u2019t redeem any credits. They expire automatically when the plan ends.")),(0,o.kt)("p",null,"The credits redemption flow is as follows:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"A user holding a payment plan giving access to an AI Agent wants to access to send a query to it"),(0,o.kt)("li",{parentName:"ol"},"The user via Nevermined libraries get the JWT access token to the Agent via the Nevermined Node (this process only needs to be do once per agent, not per request)"),(0,o.kt)("li",{parentName:"ol"},"The user sends a HTTP request to the AI Agent through a Nevermined Proxy. The user sends in the HTTP Authorization header the JWT token."),(0,o.kt)("li",{parentName:"ol"},"The Proxy validates the request and checks the user has enough credits to query the AI Agent."),(0,o.kt)("li",{parentName:"ol"},"If that\u2019s the case the user request is proxied to the upstream AI Agent. The proxy decrypts and replaces the JWT by the correct AI agent authorization."),(0,o.kt)("li",{parentName:"ol"},"The upstream AI Agent gets the request and processes it. If the agent redemption criteria is dynamic credits, the AI Agent calculates the cost of the user request depending on complexity."),(0,o.kt)("li",{parentName:"ol"},"The AI Agent returns the output and the response HTTP Header NVMCreditsConsumed with the number of credits to redeem."),(0,o.kt)("li",{parentName:"ol"},"The Proxy returns the AI Agent to the end user"),(0,o.kt)("li",{parentName:"ol"},"Asynchronously the Proxy validates the number of costs in credits reported by the AI Agent and if it\u2019s between the minimum and maximum, redeems (burn) these credits.")),(0,o.kt)("br",null),(0,o.kt)("p",null,"The AI Agent only can report credits to redeem between the thresholds specified in the AI Agent metadata. If the AI Agent reports a number of credits out of that range (for example overcharging the number of credits) the Nevermined Proxy will redeem the minimum amount of credits specified in the agent metadata."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Sequence of an AI Agent credits redemption",src:r(34165).Z,width:"960",height:"540"})))}l.isMDXComponent=!0},34165:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/sequence_credits_redemption-78adb11ae15de86f84a3c4829bd09a2a.png"}}]);