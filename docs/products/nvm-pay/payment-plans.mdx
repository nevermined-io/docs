---
title: "Payment Plans"
description: "Flexible pricing models for AI services"
icon: "tags"
---

## Overview

Payment Plans in Nevermined Pay define the commercial relationship between AI builders and their users. Each plan consists of two core configurations: pricing and credits.

## Plan Types

### Time-Based Plans (Subscriptions)

Perfect for unlimited access within a time period:

```typescript
// Monthly subscription for $29.99
const planMetadata = {
  name: 'Pro Monthly',
  description: 'Unlimited access for 30 days'
}

const priceConfig = getFiatPriceConfig(
  29_990_000n, // $29.99 (8 decimals)
  builderAddress
)

const timeConfig = getExpirableDurationConfig(
  86400n * 30n // 30 days in seconds
)

const { planId } = await payments.plans.registerTimePlan(
  planMetadata,
  priceConfig,
  timeConfig
)
```

### Credit-Based Plans (Usage)

Ideal for pay-per-use models:

```typescript
// 100 credits for 10 USDC
const planMetadata = {
  name: 'Starter Pack',
  description: '100 API calls'
}

const priceConfig = getERC20PriceConfig(
  10_000_000n, // 10 USDC
  USDC_ADDRESS,
  builderAddress
)

const creditsConfig = getFixedCreditsConfig(
  100n, // Total credits
  1n    // Credits per request
)

const { planId } = await payments.plans.registerCreditsPlan(
  planMetadata,
  priceConfig,
  creditsConfig
)
```

### Hybrid Plans

Combine time limits with usage caps:

```typescript
// Note: Hybrid plans with both credits and time limits require custom configuration
// For time-based plans, use getExpirableDurationConfig()
// For credits-based plans, use getFixedCreditsConfig()
// Hybrid configurations combining both are not directly supported by helper functions
// and require manual configuration or custom implementation
import { getExpirableDurationConfig } from '@nevermined-io/payments'
import { ONE_MONTH_DURATION } from '@nevermined-io/payments'

// Example: Time-based plan (credits per request is always 1 for time-based plans)
const timeBasedPlan = getExpirableDurationConfig(ONE_MONTH_DURATION)
```

## Trial Plans

Trial plans allow users to try your service for free. Each user can only obtain a trial plan once. There are two types:

### Credits-Based Trial Plan

Give users a fixed number of free credits:

```typescript
import { getFreePriceConfig, getFixedCreditsConfig } from '@nevermined-io/payments'

const trialPlanMetadata = {
  name: 'Free Trial - 10 Credits',
  description: 'Try our service with 10 free credits'
}

const freePriceConfig = getFreePriceConfig()
const trialCreditsConfig = getFixedCreditsConfig(10n)

const { planId } = await payments.plans.registerCreditsTrialPlan(
  trialPlanMetadata,
  freePriceConfig,
  trialCreditsConfig
)
```

### Time-Based Trial Plan

Give users free access for a limited time:

```typescript
import { getFreePriceConfig, getExpirableDurationConfig, ONE_DAY_DURATION } from '@nevermined-io/payments'

const trialPlanMetadata = {
  name: 'Free Trial - 1 Day',
  description: 'Try our service free for 24 hours'
}

const freePriceConfig = getFreePriceConfig()
const timeTrialConfig = getExpirableDurationConfig(ONE_DAY_DURATION)

const { planId } = await payments.plans.registerTimeTrialPlan(
  trialPlanMetadata,
  freePriceConfig,
  timeTrialConfig
)
```

## Dynamic Pricing

For variable credit consumption based on request complexity:

```typescript
import { getDynamicCreditsConfig } from '@nevermined-io/payments'

const dynamicConfig = getDynamicCreditsConfig(
  1000n,              // Total credits
  1n,                 // Minimum credits per request
  50n                 // Maximum credits per request
)
```

## Plan Management

### Multiple Plans per Agent

Offer different tiers for different user segments:

```typescript
const plans = []

// Basic tier
const basic = await payments.plans.registerCreditsPlan(
  { name: 'Basic', description: 'For individuals' },
  getFiatPriceConfig(9_990_000n, builderAddress),
  getFixedCreditsConfig(100n, 1n)
)
plans.push(basic.planId)

// Pro tier
const pro = await payments.plans.registerCreditsPlan(
  { name: 'Pro', description: 'For teams' },
  getFiatPriceConfig(49_990_000n, builderAddress),
  getFixedCreditsConfig(1000n, 1n)
)
plans.push(pro.planId)

// Define agent metadata and API
const agentMetadata = {
  name: 'My AI Service',
  tags: ['ai', 'service']
}

const agentApi = {
  endpoints: [{ POST: 'https://api.example.com/query' }],
  agentDefinitionUrl: 'https://api.example.com/openapi.json' // URL to OpenAPI spec, MCP Manifest, or A2A agent card
}

// Register agent with all plans
const { agentId } = await payments.agents.registerAgent(
  agentMetadata,
  agentApi,
  plans
)
```

### Plan Lifecycle

<Steps>
  <Step title="Creation">
    Define price and credit configurations
  </Step>
  <Step title="Association">
    Link plans to AI agents
  </Step>
  <Step title="Discovery">
    Users browse available plans
  </Step>
  <Step title="Purchase">
    Users buy plans to gain access
  </Step>
  <Step title="Usage">
    Credits consumed as service is used
  </Step>
</Steps>

## Configuration Reference

### PriceConfig

```typescript
interface PriceConfig {
  priceType: 'FIXED_PRICE' | 'DYNAMIC_PRICE'
  tokenAddress: string      // ERC-20 token or '0x0' for native
  amounts: bigint[]        // Payment amounts
  receivers: string[]      // Payment recipients
}
```

### CreditsConfig

```typescript
interface CreditsConfig {
  creditsType: 'FIXED' | 'EXPIRABLE' | 'DYNAMIC'
  amount: bigint                    // Total credits
  creditsPerRequest?: bigint        // Fixed consumption
  minCreditsPerRequest?: bigint     // Dynamic minimum
  maxCreditsPerRequest?: bigint     // Dynamic maximum
  durationOfThePlan?: bigint        // Expiration time
}
```

## Best Practices

<AccordionGroup>
  <Accordion title="Pricing Strategy">
    - Research competitor pricing
    - Start with simple models
    - Offer clear value tiers
    - Consider free trials
  </Accordion>
  <Accordion title="Credit Allocation">
    - Set reasonable limits
    - Monitor usage patterns
    - Adjust based on costs
    - Provide usage visibility
  </Accordion>
  <Accordion title="Plan Design">
    - Name plans clearly
    - Write descriptive metadata
    - Group related features
    - Highlight differences
  </Accordion>
</AccordionGroup>